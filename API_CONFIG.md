# BWEnews WebSocket é…ç½®è¯´æ˜Ž

## ðŸ“¡ å·²æŽ¥å…¥çš„çœŸå®žæ•°æ®æº

é¡¹ç›®å·²æˆåŠŸæŽ¥å…¥ **BWEnews WebSocket**ï¼Œå®žæ—¶æŽ¨é€åŠ å¯†è´§å¸æ–°é—»æ•°æ®ã€‚

---

## ðŸ”§ å½“å‰é…ç½®

### WebSocket Endpoint
```
wss://bwenews-api.bwe-ws.com/ws
```

### è¿žæŽ¥ç‰¹æ€§
- **è¿žæŽ¥æ–¹å¼**: WebSocketï¼ˆå®žæ—¶æŽ¨é€ï¼‰
- **å¿ƒè·³æœºåˆ¶**: æ¯30ç§’å‘é€ `ping`ï¼ŒæŽ¥æ”¶ `pong`
- **è‡ªåŠ¨é‡è¿ž**: æ–­çº¿åŽ5ç§’è‡ªåŠ¨é‡è¿ž
- **å¤‡ç”¨æ•°æ®æº**: WebSocketæ–­å¼€æ—¶ä½¿ç”¨æœ¬åœ°æ¨¡æ‹Ÿæ•°æ®ï¼ˆ3åˆ†é’Ÿ/æ¬¡ï¼‰

### æ•°æ®å¤„ç†æµç¨‹
```
BWEnews WebSocket â†’ å®žæ—¶æŽ¨é€ â†’ æ–°é—»è§£æž â†’ åŽ»é‡æ£€æŸ¥ â†’ AIåˆ†æžé˜Ÿåˆ— â†’ Geminiåˆ†æž â†’ æƒ…ç»ªæ›´æ–°
```

---

## ðŸ“‹ WebSocket æ¶ˆæ¯æ ¼å¼

### æ ‡å‡†æ–°é—»æ¶ˆæ¯
```json
{
  "source_name": "BWENEWS",
  "news_title": "This is a test message news",
  "coins_included": ["BTC", "ETH", "SOL"],
  "url": "https://bwenews123.com/asdads",
  "timestamp": 1745770800
}
```

### å¿ƒè·³æ¶ˆæ¯
- **å‘é€**: `ping` (çº¯æ–‡æœ¬)
- **æŽ¥æ”¶**: `pong` (çº¯æ–‡æœ¬)

### å­—æ®µè¯´æ˜Ž
- `source_name`: æ•°æ®æºæ ‡è¯†ï¼ˆå›ºå®šä¸º "BWENEWS"ï¼‰
- `news_title`: æ–°é—»æ ‡é¢˜
- `coins_included`: ç›¸å…³å¸ç§æ•°ç»„ï¼ˆå¦‚ ["BTC", "ETH"]ï¼‰
- `url`: æ–°é—»è¯¦æƒ…é“¾æŽ¥
- `timestamp`: Unixæ—¶é—´æˆ³ï¼ˆç§’ï¼‰

---

## âš™ï¸ è‡ªå®šä¹‰é…ç½®

### ä¿®æ”¹WebSocketåœ°å€
å¦‚æžœWebSocketåœ°å€å˜æ›´ï¼Œè¯·ä¿®æ”¹ `App.tsx` ç¬¬100è¡Œï¼š

```typescript
const socket = new WebSocket('wss://bwenews-api.bwe-ws.com/ws');
```

### ä¿®æ”¹å¿ƒè·³é—´éš”
åœ¨ `App.tsx` ç¬¬112è¡Œä¿®æ”¹ï¼š

```typescript
}, 30000); // æ”¹ä¸ºä½ éœ€è¦çš„æ¯«ç§’æ•°ï¼ˆ30000 = 30ç§’ï¼‰
```

### ä¿®æ”¹é‡è¿žå»¶è¿Ÿ
åœ¨ `App.tsx` ç¬¬179è¡Œä¿®æ”¹ï¼š

```typescript
}, 5000); // æ”¹ä¸ºä½ éœ€è¦çš„æ¯«ç§’æ•°ï¼ˆ5000 = 5ç§’ï¼‰
```

### è‡ªå®šä¹‰æ–°é—»æ ‡é¢˜æ ¼å¼
åœ¨ `App.tsx` ç¬¬137-139è¡Œä¿®æ”¹ï¼š

```typescript
// å½“å‰æ ¼å¼: [BTC, ETH] æ–°é—»æ ‡é¢˜
const fullTitle = coins.length > 0
  ? `[${coins.join(', ')}] ${title}`
  : title;

// å¯æ”¹ä¸ºå…¶ä»–æ ¼å¼ï¼Œä¾‹å¦‚:
// const fullTitle = `${title} (${coins.join(', ')})`;
// const fullTitle = `${coins.join('/')} - ${title}`;
```

---

## ðŸ” æ•°æ®å­—æ®µæ˜ å°„

ä»£ç ä¼šè‡ªåŠ¨å¤„ç†BWEnews WebSocketçš„æ ‡å‡†æ ¼å¼ï¼š

```typescript
// æå–å­—æ®µ
const title = message.news_title;           // æ–°é—»æ ‡é¢˜
const coins = message.coins_included || []; // ç›¸å…³å¸ç§
const url = message.url || '';              // æ–°é—»é“¾æŽ¥
const timestamp = message.timestamp;        // æ—¶é—´æˆ³
```

å¦‚æžœå­—æ®µåå˜æ›´ï¼Œè¯·ä¿®æ”¹ `App.tsx` ç¬¬131-134è¡Œã€‚

---

## ðŸš¨ é”™è¯¯å¤„ç†

### è‡ªåŠ¨é‡è¿žæœºåˆ¶
- WebSocketæ–­å¼€åŽï¼Œ5ç§’è‡ªåŠ¨é‡è¿ž
- æœ€å¤šæ— é™æ¬¡é‡è¯•ï¼ˆç›´åˆ°è¿žæŽ¥æˆåŠŸï¼‰
- çŠ¶æ€æ˜¾ç¤ºä¼šä»Ž `connected` å˜ä¸º `disconnected`

### è‡ªåŠ¨é™çº§æœºåˆ¶
- WebSocketé•¿æ—¶é—´æ–­å¼€æ—¶ï¼Œä½¿ç”¨æœ¬åœ°æ¨¡æ‹Ÿæ•°æ®ï¼ˆ3åˆ†é’Ÿ/æ¬¡ï¼‰
- è¿žæŽ¥æ¢å¤åŽè‡ªåŠ¨åˆ‡æ¢å›žå®žæ—¶æ•°æ®

### æŸ¥çœ‹è¿žæŽ¥æ—¥å¿—
æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼ŒæŸ¥çœ‹Consoleæ ‡ç­¾ï¼š
```
ðŸ”Œ æ­£åœ¨è¿žæŽ¥ BWEnews WebSocket...
âœ… BWEnews WebSocket è¿žæŽ¥æˆåŠŸ
ðŸ’“ å‘é€å¿ƒè·³: ping
ðŸ’“ æ”¶åˆ°å¿ƒè·³å“åº”: pong
ðŸ“° æ”¶åˆ°æ–°é—»: {...}
ðŸ“Š å¤„ç†æ–°é—»: [BTC, ETH] ...
```

---

## ðŸ“Š çŠ¶æ€ç›‘æŽ§

Dashboardç•Œé¢ä¼šå®žæ—¶æ˜¾ç¤ºï¼š
- **SYSTEMçŠ¶æ€**: connected / connecting / disconnected
- **Sync Hits**: å·²æŽ¥æ”¶çš„æ–°é—»æ€»æ•°
- **AI Buffer**: å¾…åˆ†æžçš„æ–°é—»é˜Ÿåˆ—é•¿åº¦

---

## ðŸ§ª æµ‹è¯•WebSocketè¿žæŽ¥

### æ–¹æ³•1ï¼šè¿è¡Œé¡¹ç›®æŸ¥çœ‹æŽ§åˆ¶å°
```bash
npm run dev
```
æ‰“å¼€æµè§ˆå™¨æŽ§åˆ¶å°ï¼ˆF12ï¼‰ï¼ŒæŸ¥çœ‹è¿žæŽ¥æ—¥å¿—ï¼š
- âœ… çœ‹åˆ° "BWEnews WebSocket è¿žæŽ¥æˆåŠŸ" = è¿žæŽ¥æ­£å¸¸
- ðŸ’“ å®šæœŸçœ‹åˆ° "å‘é€å¿ƒè·³: ping" å’Œ "æ”¶åˆ°å¿ƒè·³å“åº”: pong" = è¿žæŽ¥ä¿æŒæ´»è·ƒ
- ðŸ“° çœ‹åˆ° "æ”¶åˆ°æ–°é—»: {...}" = æ­£åœ¨æŽ¥æ”¶å®žæ—¶æ•°æ®

### æ–¹æ³•2ï¼šä½¿ç”¨åœ¨çº¿WebSocketæµ‹è¯•å·¥å…·
è®¿é—®ï¼šhttps://www.websocket.org/echo.html
1. è¾“å…¥åœ°å€ï¼š`wss://bwenews-api.bwe-ws.com/ws`
2. ç‚¹å‡» "Connect"
3. å‘é€ `ping`ï¼Œåº”æ”¶åˆ° `pong`
4. ç­‰å¾…æŽ¥æ”¶æ–°é—»æ¶ˆæ¯

### æ–¹æ³•3ï¼šä½¿ç”¨wscatå‘½ä»¤è¡Œå·¥å…·
```bash
# å®‰è£…wscat
npm install -g wscat

# è¿žæŽ¥WebSocket
wscat -c wss://bwenews-api.bwe-ws.com/ws

# å‘é€å¿ƒè·³
> ping
< pong

# ç­‰å¾…æŽ¥æ”¶æ–°é—»
< {"source_name":"BWENEWS","news_title":"...","coins_included":["BTC"],...}
```

---

## ðŸ”§ å¸¸è§é—®é¢˜

### WebSocketè¿žæŽ¥å¤±è´¥
**ç—‡çŠ¶**: æŽ§åˆ¶å°æ˜¾ç¤º "WebSocketè¿žæŽ¥å¤±è´¥" æˆ–ä¸€ç›´æ˜¾ç¤º "connecting"

**å¯èƒ½åŽŸå› **:
1. ç½‘ç»œé—®é¢˜æˆ–é˜²ç«å¢™é˜»æ­¢WebSocketè¿žæŽ¥
2. WebSocketæœåŠ¡å™¨æš‚æ—¶ä¸å¯ç”¨
3. æµè§ˆå™¨ä¸æ”¯æŒWebSocketï¼ˆæžå°‘è§ï¼‰

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
2. å°è¯•ä½¿ç”¨å…¶ä»–ç½‘ç»œï¼ˆå¦‚åˆ‡æ¢WiFi/4Gï¼‰
3. ç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨æœ¬åœ°æ¨¡æ‹Ÿæ•°æ®ä½œä¸ºå¤‡ä»½
4. ç­‰å¾…è‡ªåŠ¨é‡è¿žï¼ˆæ¯5ç§’å°è¯•ä¸€æ¬¡ï¼‰

### å¿ƒè·³è¶…æ—¶
**ç—‡çŠ¶**: è¿žæŽ¥å»ºç«‹åŽå¾ˆå¿«æ–­å¼€

**è§£å†³æ–¹æ¡ˆ**:
- æ£€æŸ¥ `App.tsx` ç¬¬112è¡Œçš„å¿ƒè·³é—´éš”è®¾ç½®
- ç¡®ä¿å¿ƒè·³é—´éš”ä¸è¶…è¿‡æœåŠ¡å™¨è¶…æ—¶æ—¶é—´
- å½“å‰é»˜è®¤30ç§’ï¼Œé€šå¸¸æ— éœ€ä¿®æ”¹

### æ”¶ä¸åˆ°æ–°é—»æ•°æ®
**ç—‡çŠ¶**: WebSocketå·²è¿žæŽ¥ï¼Œä½†æ²¡æœ‰æ–°é—»æŽ¨é€

**å¯èƒ½åŽŸå› **:
1. å½“å‰æ—¶æ®µæ²¡æœ‰æ–°é—»å‘å¸ƒï¼ˆæ­£å¸¸çŽ°è±¡ï¼‰
2. æ¶ˆæ¯æ ¼å¼ä¸åŒ¹é…

**è§£å†³æ–¹æ¡ˆ**:
1. è€å¿ƒç­‰å¾…ï¼ˆåŠ å¯†è´§å¸æ–°é—»ä¸æ˜¯æ¯ç§’éƒ½æœ‰ï¼‰
2. æŸ¥çœ‹æŽ§åˆ¶å°æ˜¯å¦æœ‰ "æ”¶åˆ°æ–°é—»" æ—¥å¿—
3. å¦‚æžœæœ‰æ—¥å¿—ä½†æ²¡æ˜¾ç¤ºï¼Œæ£€æŸ¥æ•°æ®æ ¼å¼è§£æžé€»è¾‘

---

## ðŸ“ž éœ€è¦äººå·¥æ“ä½œçš„éƒ¨åˆ†

### âœ… æ— éœ€é¢å¤–æ“ä½œ
å½“å‰å®žçŽ°**ä¸éœ€è¦**ä»»ä½•äººå·¥é…ç½®æˆ–é¢å¤–èµ„æºï¼š
- âœ… ä»£ç å·²å®Œæˆä¿®æ”¹
- âœ… è‡ªåŠ¨é‡è¿žæœºåˆ¶å·²å®žçŽ°
- âœ… è‡ªåŠ¨é™çº§åˆ°æœ¬åœ°æ•°æ®ï¼ˆWebSocketæ–­å¼€æ—¶ï¼‰
- âœ… é”™è¯¯å¤„ç†å·²å®Œå–„

### âš ï¸ å¯é€‰æ“ä½œï¼ˆä»…åœ¨ç‰¹æ®Šæƒ…å†µä¸‹éœ€è¦ï¼‰
1. **å¦‚æžœéœ€è¦è®¤è¯**ï¼ˆå½“å‰ä¸éœ€è¦ï¼‰
   - èŽ·å–APIå¯†é’¥
   - æ·»åŠ åˆ° `.env.local` æ–‡ä»¶
   - ä¿®æ”¹è¿žæŽ¥ä»£ç æ·»åŠ è®¤è¯å¤´

2. **å¦‚æžœé‡åˆ°ç½‘ç»œé—®é¢˜**
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
   - å°è¯•å…¶ä»–ç½‘ç»œçŽ¯å¢ƒ

---

## ðŸŽ¯ éªŒè¯æŽ¥å…¥æˆåŠŸ

è¿è¡Œé¡¹ç›®åŽï¼Œæ£€æŸ¥ä»¥ä¸‹æŒ‡æ ‡ï¼š

1. **çŠ¶æ€æŒ‡ç¤ºå™¨**: åº”æ˜¾ç¤º `SYSTEM: connected`ï¼ˆç»¿è‰²ï¼‰
2. **Sync Hits**: æ•°å­—åº”éšæ–°é—»æŽ¨é€å¢žåŠ 
3. **æŽ§åˆ¶å°æ—¥å¿—**: åº”çœ‹åˆ° "BWEnews WebSocket è¿žæŽ¥æˆåŠŸ" å’Œå®šæœŸçš„å¿ƒè·³æ—¥å¿—
4. **æ–°é—»æµ**: Dashboardåº”æ˜¾ç¤ºçœŸå®žçš„åŠ å¯†è´§å¸æ–°é—»ï¼ˆå¸¦å¸ç§æ ‡ç­¾å¦‚ [BTC, ETH]ï¼‰

å¦‚æžœæ˜¾ç¤º `disconnected`ï¼Œè¯´æ˜ŽWebSocketæš‚æ—¶ä¸å¯ç”¨ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é‡è¿žå¹¶ä½¿ç”¨æœ¬åœ°æ¨¡æ‹Ÿæ•°æ®ã€‚

---

## ðŸ“š ç›¸å…³æ–‡ä»¶

- **App.tsx**: ä¸»åº”ç”¨é€»è¾‘ï¼ŒåŒ…å«WebSocketè¿žæŽ¥ä»£ç ï¼ˆç¬¬90-233è¡Œï¼‰
- **API_CONFIG.md**: æœ¬æ–‡æ¡£ï¼ŒWebSocketé…ç½®è¯´æ˜Ž
- **.env.local**: çŽ¯å¢ƒå˜é‡é…ç½®ï¼ˆGemini APIå¯†é’¥ï¼‰

---

## ðŸ’¡ æç¤º

1. **é¦–æ¬¡è¿è¡Œ**: ç›´æŽ¥ `npm run dev` å³å¯ï¼Œæ— éœ€é¢å¤–é…ç½®
2. **è¿žæŽ¥å¤±è´¥**: ç³»ç»Ÿä¼šè‡ªåŠ¨é‡è¿žå¹¶ä½¿ç”¨æœ¬åœ°æ¨¡æ‹Ÿæ•°æ®ï¼Œä¸å½±å“åŠŸèƒ½æ¼”ç¤º
3. **è°ƒè¯•**: æ‰“å¼€æµè§ˆå™¨æŽ§åˆ¶å°æŸ¥çœ‹è¯¦ç»†çš„è¿žæŽ¥å’Œæ•°æ®æ—¥å¿—
4. **è‡ªå®šä¹‰**: å‚è€ƒä¸Šè¿°é…ç½®è¯´æ˜Žä¿®æ”¹å¿ƒè·³é—´éš”ã€é‡è¿žå»¶è¿Ÿç­‰

---

## ðŸŽ¯ ä¼˜åŠ¿å¯¹æ¯”

| ç‰¹æ€§ | REST APIè½®è¯¢ | WebSocketå®žæ—¶æŽ¨é€ |
|------|-------------|------------------|
| **å®žæ—¶æ€§** | 60ç§’å»¶è¿Ÿ | âœ… å³æ—¶æŽ¨é€ï¼ˆ<1ç§’ï¼‰ |
| **æœåŠ¡å™¨è´Ÿè½½** | é«˜ï¼ˆé¢‘ç¹è¯·æ±‚ï¼‰ | âœ… ä½Žï¼ˆä¿æŒè¿žæŽ¥ï¼‰ |
| **ç½‘ç»œæµé‡** | é«˜ï¼ˆé‡å¤è¯·æ±‚å¤´ï¼‰ | âœ… ä½Žï¼ˆä»…æ•°æ®ï¼‰ |
| **è¿žæŽ¥ç¨³å®šæ€§** | æ¯æ¬¡ç‹¬ç«‹ | âœ… é•¿è¿žæŽ¥+å¿ƒè·³ |
| **æ•°æ®å®Œæ•´æ€§** | å¯èƒ½é—æ¼ | âœ… ä¸é—æ¼ |

---

**æœ€åŽæ›´æ–°**: 2026-02-11
**æ•°æ®æº**: BWEnews WebSocket
**ç«¯ç‚¹**: wss://bwenews-api.bwe-ws.com/ws
**çŠ¶æ€**: âœ… å·²æŽ¥å…¥å¹¶æµ‹è¯•

